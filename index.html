<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å¤§å­¦å“çƒéƒ¨å°‚ç”¨æ™‚é–“ç®¡ç†ã‚¿ã‚¤ãƒãƒ¼</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            text-align: center;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            height: 100vh;
            margin: 0;
            background-color: #FFFFFF; /* ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆèƒŒæ™¯è‰² */
            transition: background-color 0.5s;
        }

        .container {
            width: 90%;
            max-width: 500px;
        }

        #menu-display {
            font-size: 2.5rem;
            font-weight: bold;
            margin-bottom: 20px;
        }

        #timer {
            font-size: 5rem;
            font-weight: bold;
            margin: 20px 0;
        }

        .buttons {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 30px;
        }

        button {
            padding: 15px 30px;
            font-size: 1.5rem;
            border: none;
            border-radius: 10px;
            background-color: #007bff;
            color: white;
            cursor: pointer;
            transition: background-color 0.3s;
        }

        button:hover {
            background-color: #0056b3;
        }

        .blue-bg {
            background-color: #87CEFA; /* æ°´è‰² (nâ‰ 0) */
        }

        .green-bg {
            background-color: #90EE90; /* é»„ç·‘è‰² (n=0) */
        }
    </style>
</head>
<body>
    <audio id="finishSound" src="finished1.mp3" preload="auto"></audio>

    <div class="container">
        <div id="menu-display">F0</div>
        <div id="timer">00:03</div>
        <div class="buttons">
            <button id="start-stop">start</button>
            <button id="reset">reset</button>
        </div>
    </div>

    <script>
        // ãƒ†ãƒ¼ãƒ–ãƒ«ã®å®šç¾©
        const table = [
            { menu: "ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒ«", time: "00:03" },
            { menu: "ãƒ•ã‚©ã‚¢ï¼ˆé€šå¸¸ï¼‰", time: "00:03" },
            { menu: "ãƒ•ã‚©ã‚¢ï¼ˆãƒ‰ãƒ©ã‚¤ãƒ–vsãƒ–ãƒ­ãƒƒã‚¯1ï¼‰", time: "00:03" },
            { menu: "ãƒ•ã‚©ã‚¢ï¼ˆãƒ‰ãƒ©ã‚¤ãƒ–vsãƒ–ãƒ­ãƒƒã‚¯2ï¼‰", time: "00:03" },
            { menu: "ãƒãƒƒã‚¯ï¼ˆé€šå¸¸ï¼‰", time: "00:03" },
            { menu: "ãƒãƒƒã‚¯ï¼ˆãƒ‰ãƒ©ã‚¤ãƒ–vsãƒ–ãƒ­ãƒƒã‚¯1ï¼‰", time: "00:03" },
            { menu: "ãƒãƒƒã‚¯ï¼ˆãƒ‰ãƒ©ã‚¤ãƒ–vsãƒ–ãƒ­ãƒƒã‚¯2ï¼‰", time: "00:03" },
            { menu: "ã‚¹ãƒˆãƒ¬ãƒ¼ãƒˆãƒ•ã‚©ã‚¢", time: "00:03" },
            { menu: "ã‚¹ãƒˆãƒ¬ãƒ¼ãƒˆãƒãƒƒã‚¯", time: "00:03" },
            { menu: "å°ä¸Šãƒ•ã‚©ã‚¢", time: "00:03" },
            { menu: "å°ä¸Šãƒãƒƒã‚¯", time: "00:03" },
            { menu: "å°ä¸Šå…¨é¢", time: "00:03" },
            { menu: "å¼•ãåˆã„ãƒ•ã‚©ã‚¢", time: "00:03" },
            { menu: "å¼•ãåˆã„ãƒãƒƒã‚¯", time: "00:03" }
        ];

        // DOMè¦ç´ ã®å–å¾—
        const menuDisplay = document.getElementById('menu-display');
        const timerDisplay = document.getElementById('timer');
        const startStopButton = document.getElementById('start-stop');
        const resetButton = document.getElementById('reset');
        const sound = document.getElementById("finishSound");

        // å¤‰æ•°ã®åˆæœŸåŒ–
        let currentIndex = 1; // å¤‰æ•°k - ç¾åœ¨ã®ãƒ¡ãƒ‹ãƒ¥ãƒ¼ç•ªå·
        const tableLength = 13; // å¤‰æ•°Tablen
        let timeLeft = 0; // æ®‹ã‚Šæ™‚é–“ï¼ˆç§’ï¼‰
        let timerInterval = null; // ã‚¿ã‚¤ãƒãƒ¼ã®ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒ«ID
        let isRunning = false; // ã‚¿ã‚¤ãƒãƒ¼å®Ÿè¡Œä¸­ã‹ã©ã†ã‹
        let isInterval = false; // ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒ«ä¸­ã‹ã©ã†ã‹

        let audioInitialized = false;

        function initializeAudio() {
            if (!audioInitialized) {
                sound.play().then(() => {
                    sound.pause(); // ç„¡éŸ³å†ç”Ÿå¾Œã™ãã«æ­¢ã‚ã‚‹
                    sound.currentTime = 0;
                    audioInitialized = true;
                }).catch(e => {
                    console.log("Audio init failed:", e);
                });
            }
        }

        // æ™‚é–“æ–‡å­—åˆ—ã‚’ç§’ã«å¤‰æ›ã™ã‚‹é–¢æ•°
        function timeToSeconds(timeStr) {
            const [minutes, seconds] = timeStr.split(':').map(Number);
            return minutes * 60 + seconds;
        }

        // ç§’ã‚’æ™‚é–“æ–‡å­—åˆ—ã«å¤‰æ›ã™ã‚‹é–¢æ•°
        function secondsToTime(seconds) {
            const mins = Math.floor(seconds / 60);
            const secs = seconds % 60;
            return `${mins.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}`;
        }

        // set(n)é–¢æ•°ï¼šnã®Menuã¨Timeã‚’è¨­å®š
        function setMenu(n) {
            menuDisplay.textContent = table[n].menu;
            timeLeft = timeToSeconds(table[n].time);
            updateTimerDisplay();
            
            // èƒŒæ™¯è‰²ã‚’å¤‰æ›´
            updateBackgroundColor(n);
            
            // ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒ«ãƒ•ãƒ©ã‚°ã‚’æ›´æ–°
            isInterval = (n === 0);
        }

        // èƒŒæ™¯è‰²ã‚’æ›´æ–°ã™ã‚‹é–¢æ•°
        function updateBackgroundColor(n) {
            document.body.classList.remove('blue-bg', 'green-bg');
            
            if (n === 0) {
                document.body.classList.add('green-bg'); // n=0ã®ã¨ãé»„ç·‘è‰²
            } else {
                document.body.classList.add('blue-bg'); // nâ‰ 0ã®ã¨ãæ°´è‰²ï¼ˆn=1ã‚‚å«ã‚€ï¼‰
            }
        }

        // Timerè¡¨ç¤ºã®æ›´æ–°
        function updateTimerDisplay() {
            timerDisplay.textContent = secondsToTime(timeLeft);
        }

        // ã‚¿ã‚¤ãƒãƒ¼ã®é–‹å§‹
        function startTimer() {
            if (!isRunning) {
                isRunning = true;
                startStopButton.textContent = 'stop';
                
                timerInterval = setInterval(() => {
                    if (timeLeft > 0) {
                        timeLeft--;
                        updateTimerDisplay();
                    } else {
                        // timer0ã®å‡¦ç†
                        handleTimerZero();
                    }
                }, 1000);
            }
        }

        // ã‚¿ã‚¤ãƒãƒ¼ãŒã‚¼ãƒ­ã«ãªã£ãŸã¨ãã®å‡¦ç†
        function handleTimerZero() {
            clearInterval(timerInterval);
            isRunning = false;
            startStopButton.textContent = 'start';
            
            if (isInterval) {
                // ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒ«ãŒçµ‚äº†ã—ãŸã‚‰ã€æ¬¡ã®ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã¸é€²ã‚€
                setMenu(currentIndex);
                startTimer(); // è‡ªå‹•çš„ã«start
            } else {
                // é€šå¸¸ãƒ¡ãƒ‹ãƒ¥ãƒ¼ãŒçµ‚äº†ã—ãŸå ´åˆ
                if (currentIndex < tableLength) {
                    // æœ€å¾Œã®ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã§ãªã„å ´åˆã¯ã€æ¬¡ã®ãƒ¡ãƒ‹ãƒ¥ãƒ¼ç•ªå·ã‚’è¨­å®šã—ã¦ã‹ã‚‰ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒ«ã¸
                    currentIndex++; // æ¬¡ã®ãƒ¡ãƒ‹ãƒ¥ãƒ¼ç•ªå·ã‚’è¨­å®š
                    setMenu(0);
                    startTimer(); // è‡ªå‹•çš„ã«start

                    sound.currentTime = 0; // å†ç”Ÿä½ç½®ã‚’æœ€åˆã«æˆ»ã™
                    sound.play();

                } else {
                    // æœ€å¾Œã®ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã®å ´åˆã¯ã€æœ€åˆã®ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã«æˆ»ã—ã€ã‚¿ã‚¤ãƒãƒ¼ã¯ã‚¹ãƒˆãƒƒãƒ—çŠ¶æ…‹ã§å¾…æ©Ÿ
                    currentIndex = 1;
                    setMenu(currentIndex);
                    // startTimerã¯å‘¼ã³å‡ºã•ãªã„
                }
            }
        }

        // ã‚¿ã‚¤ãƒãƒ¼ã®åœæ­¢
        function stopTimer() {
            if (isRunning) {
                isRunning = false;
                startStopButton.textContent = 'start';
                clearInterval(timerInterval);
            }
        }

        // s/sãƒœã‚¿ãƒ³ã®ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼
        startStopButton.addEventListener('click', () => {
            initializeAudio(); // ğŸ”Šè¿½åŠ ï¼
            if (isRunning) {
                stopTimer();
            } else {
                startTimer();
            }
        });

        // resetãƒœã‚¿ãƒ³ã®ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼
        resetButton.addEventListener('click', () => {
            stopTimer();
            setMenu(isInterval ? 0 : currentIndex);
        });

        // åˆæœŸåŒ–ï¼šset(1)
        setMenu(1);
        // æ³¨æ„: åˆæœŸåŒ–æ™‚ã¯startã—ãªã„ï¼ˆè¨­è¨ˆæ›¸ã®æŒ‡ç¤ºé€šã‚Šï¼‰
    </script>
</body>
</html>
